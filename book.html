<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Book a Session – Amit Tutoring</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="style.css" />
</head>
<body data-no-auto-init="true" data-page-id="book">
  <!-- <header> -->
    <div id="site-header"></div>
    <script src="header-loader.js"></script>
  <!-- </header> -->

<main class="container">
  <h2 data-editable-block="heroTitle">Book a Tutoring Session</h2>
  <p data-editable-block="introBlurb">
    If your <a href="edit-profile.html">email notification</a> is on, then
    you'll get a confirmation by email after I approve the request.
  </p>

  <form id="booking-form" class="card">
    <div class="students-grid">
      <div class="field-row">
        <label>Student 1 (Primary)*</label>
        <select name="student_1" id="student-1" title="Primary student for this session" required>
          <option value="">Select student...</option>
        </select>
      </div>

      <div class="field-row">
        <label>Student 2</label>
        <select name="student_2" id="student-2" title="Optional second student">
          <option value="">Select student...</option>
        </select>
      </div>

      <div class="field-row">
        <label>Student 3</label>
        <select name="student_3" id="student-3" title="Optional third student">
          <option value="">Select student...</option>
        </select>
      </div>

      <div class="field-row">
        <label>Student 4</label>
        <select name="student_4" id="student-4" title="Optional fourth student">
          <option value="">Select student...</option>
        </select>
      </div>

      <div class="field-row">
        <label>Student 5</label>
        <select name="student_5" id="student-5" title="Optional fifth student">
          <option value="">Select student...</option>
        </select>
      </div>

      <div class="field-row">
        <label>Student 6</label>
        <select name="student_6" id="student-6" title="Optional sixth student">
          <option value="">Select student...</option>
        </select>
      </div>

      <div class="field-row">
        <label>Student 7</label>
        <select name="student_7" id="student-7" title="Optional seventh student">
          <option value="">Select student...</option>
        </select>
      </div>

      <div class="field-row">
        <label>Student 8</label>
        <select name="student_8" id="student-8" title="Optional eighth student">
          <option value="">Select student...</option>
        </select>
      </div>
    </div>

    <div class="field-row" style="margin-top: -0.5rem; margin-bottom: 1rem;">
      <p class="help-text" style="margin: 0;" data-editable-block="addStudentHelp">
        Don't see your student? <a href="add-student.html" style="color: var(--primary-color); text-decoration: underline;">Add a new student</a>
      </p>
    </div>

    <div class="field-row">
      <label>Subject for this session*</label>
      <input type="text" name="subject" id="subject" placeholder="Search or choose a course" list="subject-options" autocomplete="off" required />
      <datalist id="subject-options"></datalist>
      <p class="help-text" id="subject-help"></p>
    </div>

    <div class="field-row" id="tutor-select-row">
      <label for="tutor-select">Preferred tutor</label>
      <select name="preferred_tutor" id="tutor-select">
        <option value="">No preference — assign best fit</option>
      </select>
      <p class="help-text" id="tutor-select-help">
        Your favourite tutors appear at the top of this list.
      </p>
    </div>

    <div class="field-row">
      <label>Choose a time from the availability calendar*</label>
      <p class="help-text" data-editable-block="calendarHelp">
        Choose a timeslot (at least 1 hour) by clicking on a block of time on the calendar or using the dropdowns below.
      </p>
      <div class="week-nav">
        <button type="button" id="prev-week" class="btn tertiary week-nav-btn">← Previous Week</button>
        <span id="week-display" class="week-display">Week of ...</span>
        <button type="button" id="next-week" class="btn tertiary week-nav-btn">Next Week →</button>
      </div>
      <div id="availability-calendar" class="availability-calendar">
        <!-- Filled by JS -->
      </div>
      <input type="hidden" name="selected_date" id="selected-date" />
      <input type="hidden" name="selected_start" id="selected-start" />
    </div>

    <div class="field-row time-grid">
      <div>
        <label>Day*</label>
        <select name="day_of_week" id="day-select" title="Day of Week" class="pointer-cursor" required>
          <option value="">Select day…</option>
          <option value="0">Monday</option>
          <option value="1">Tuesday</option>
          <option value="2">Wednesday</option>
          <option value="3">Thursday</option>
          <option value="4">Friday</option>
          <option value="6">Sunday</option>
        </select>
      </div>
      <div>
        <label>Start Time*</label>
        <select name="start_time" id="start-time-input" title="Start Time" class="pointer-cursor" required>
          <option value="">Select start time…</option>
        </select>
      </div>
      <div>
        <label>End Time*</label>
        <select name="duration_hours" id="duration-hours" title="End Time" required>
          <option value="">Select end time…</option>
        </select>
      </div>
    </div>

    <div class="field-row checkbox-row">
      <label>
        <input type="checkbox" id="recurring" name="recurring" title="Make this a weekly recurring session" />
        Make this a weekly recurring session
      </label>
    </div>

    <div class="field-row hidden" id="recurring-end-row">
      <label>Last date for recurring sessions (YYYY-MM-DD)*</label>
      <select name="recurring_end" id="recurring-end" title="Last date for recurring sessions">
        <option value="">Choose last date…</option>
      </select>
    </div>

    <div class="field-row">
      <label>Meeting mode*</label>
      <div class="checkbox-row" id="meeting-mode-options">
        <label><input type="radio" name="meeting_mode" value="online" id="meeting-mode-online" required /> Online</label>
        <label><input type="radio" name="meeting_mode" value="tutorsOffice" id="meeting-mode-office" /> Tutor's office</label>
        <label><input type="radio" name="meeting_mode" value="travel" id="meeting-mode-travel" /> Travel to me</label>
      </div>
      <p class="help-text" id="meeting-mode-help" data-editable-block="meetingModeHelp">Choose where the session will take place. Travel requires your address so we can confirm distance and cost.</p>
    </div>

    <div class="field-row hidden" id="travel-fields">
      <label>Your address (for travel sessions)*</label>
      <input type="text" name="travel_address" id="travel-address" placeholder="123 Main St, City" />
      <p class="help-text" id="travel-help">Enter the full address for travel sessions. Travel surcharge updates after you pick a tutor.</p>
      <div class="input-row">
        <div class="input-grow">
          <label>Notes for location</label>
          <input type="text" name="travel_instructions" id="travel-instructions" placeholder="Gate code, parking, etc." />
        </div>
        <div class="input-grow">
          <label>Estimated travel surcharge</label>
          <input type="text" id="travel-surcharge-display" value="$0" title="Estimated travel surcharge" readonly />
          <input type="hidden" id="travel-surcharge-value" name="travel_surcharge" value="0" />
        </div>
      </div>
    </div>

    <div class="field-row" id="add-ons-row">
      <label>Optional add-ons</label>
      <div id="add-on-checkboxes" class="checkbox-column"></div>
      <p class="help-text" id="add-ons-help">Add-ons are set per tutor and update when you choose a tutor.</p>
    </div>

    <div class="field-row">
      <label>Questions / Comments</label>
      <textarea name="questions" id="questions" rows="4" title="Questions / Comments"></textarea>
    </div>

    <div class="field-row checkbox-row">
      <label>
        <input type="checkbox" id="sliding-scale-toggle" name="sliding_scale_toggle" title="Apply sliding scale discount" />
        Apply sliding scale
      </label>
    </div>

    <div class="field-row hidden sliding-scale-container" id="sliding-scale-row">
      <label for="income-slider">Adjust Discount</label>
      <div class="slider-row">
        <span class="slider-label">Standard Rate</span>
        <input type="range" id="income-slider" class="slider-input" min="0" max="10" value="0" step="1" />
        <span class="slider-label">Maximum Discount</span>
      </div>
      <div class="discount-display">
        Discount: $<span id="discount-amount">0</span> off
      </div>
    </div>

    <div class="cost-row">
      <div id="cost-display" class="cost-display">
        Total Cost: $50.00 per session
      </div>
      <button type="submit" class="btn primary">Submit Booking Request</button>
    </div>

    <p id="booking-form-message" class="form-message"></p>
  </form>
</main>

<footer class="site-footer">
  <div class="container">
    <p>
      © <span id="year"></span> Amit Tutoring ·
      <a href="contact.html">Contact me</a>
    </p>
  </div>
  <script src="core.js" defer></script>
  <script src="booking.js" defer></script>
</footer>

<!-- Firebase init -->
<script type="module" src="firebase-config.js"></script>

<!-- Booking logic -->
<script type="module" src="book-page.js"></script>

<script type="module" src="page-editor.js"></script>
</body>
</html>
